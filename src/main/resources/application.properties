# Spark Qianwen Processor Configuration

# 千问模型配置
qianwen.model.name=qwen3-235b-a22b-instruct-2507
qianwen.tpm.limit=100000
qianwen.rpm.limit=500
qianwen.max.retries=3
qianwen.retry.delay.ms=1000

# 并行度配置 - 性能调优关键参数
# process.partitions: Spark处理分区数，决定并行任务数
# concurrent.calls.per.partition: 每分区内并发API调用数
# 总并发数 = process.partitions * concurrent.calls.per.partition
spark.process.partitions=10
spark.concurrent.calls.per.partition=5

# Spark配置
spark.app.name=QianwenVideoTextProcessor
spark.batch.size=100

# 数据源配置
source.table=dwd.hik_cloud2_video_text_result_hist_rand10_grouped_data_merged
target.table=dwd.dwd_device_cloudstorage_tag_by_qianwen

# ===== 性能调优指南 =====
# 如果日志显示"限流等待时间 > API调用时间"：
#   -> 瓶颈是限流配置过于保守
#   -> 解决方案：提高 qianwen.tpm.limit 或 qianwen.rpm.limit
#
# 如果日志显示"API调用时间 > 限流等待时间"：
#   -> 瓶颈是API响应速度
#   -> 解决方案：增加并发数 (concurrent.calls.per.partition)
#
# 如果出现大量429错误（rate limit）：
#   -> 实际API限流比配置更严格
#   -> 解决方案：降低 qianwen.rpm.limit
